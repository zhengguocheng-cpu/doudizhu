<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å‡ºç‰ŒéªŒè¯æµ‹è¯•</title>
    <style>
        body {
            font-family: 'Microsoft YaHei', Arial, sans-serif;
            max-width: 1200px;
            margin: 20px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        h1 {
            color: #333;
            text-align: center;
        }
        .test-section {
            background: white;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .test-case {
            margin: 10px 0;
            padding: 10px;
            border-left: 4px solid #ddd;
        }
        .test-case.pass {
            border-left-color: #4caf50;
            background: #f1f8f4;
        }
        .test-case.fail {
            border-left-color: #f44336;
            background: #fef1f0;
        }
        .test-title {
            font-weight: bold;
            margin-bottom: 5px;
        }
        .test-input {
            color: #666;
            font-family: monospace;
            margin: 5px 0;
        }
        .test-result {
            margin-top: 5px;
            font-family: monospace;
        }
        .summary {
            text-align: center;
            font-size: 24px;
            font-weight: bold;
            margin: 20px 0;
        }
        .summary.pass {
            color: #4caf50;
        }
        .summary.fail {
            color: #f44336;
        }
    </style>
</head>
<body>
    <h1>ğŸ´ æ–—åœ°ä¸»å‡ºç‰ŒéªŒè¯æµ‹è¯•</h1>
    <div id="testResults"></div>
    <div id="summary"></div>

    <script src="CardTypeDetector.js"></script>
    <script src="CardValidator.js"></script>
    <script>
        // æµ‹è¯•ç”¨ä¾‹
        const testCases = [
            // 1. é¦–æ¬¡å‡ºç‰Œæµ‹è¯•
            {
                desc: 'é¦–æ¬¡å‡ºç‰Œ - å•ç‰Œ',
                cards: ['â™ 3'],
                lastPlay: null,
                isFirstPlay: true,
                expectedValid: true
            },
            {
                desc: 'é¦–æ¬¡å‡ºç‰Œ - å¯¹å­',
                cards: ['â™ 3', 'â™¥3'],
                lastPlay: null,
                isFirstPlay: true,
                expectedValid: true
            },
            {
                desc: 'é¦–æ¬¡å‡ºç‰Œ - ç‚¸å¼¹',
                cards: ['â™ 3', 'â™¥3', 'â™¦3', 'â™£3'],
                lastPlay: null,
                isFirstPlay: true,
                expectedValid: true
            },

            // 2. è·Ÿå•ç‰Œæµ‹è¯•
            {
                desc: 'è·Ÿå•ç‰Œ - æˆåŠŸï¼ˆ4å‹3ï¼‰',
                cards: ['â™ 4'],
                lastPlay: { type: 'SINGLE', value: 3, cards: ['â™ 3'] },
                isFirstPlay: false,
                expectedValid: true
            },
            {
                desc: 'è·Ÿå•ç‰Œ - å¤±è´¥ï¼ˆ3å‹4ï¼‰',
                cards: ['â™ 3'],
                lastPlay: { type: 'SINGLE', value: 4, cards: ['â™ 4'] },
                isFirstPlay: false,
                expectedValid: false
            },

            // 3. è·Ÿå¯¹å­æµ‹è¯•
            {
                desc: 'è·Ÿå¯¹å­ - æˆåŠŸï¼ˆ44å‹33ï¼‰',
                cards: ['â™ 4', 'â™¥4'],
                lastPlay: { type: 'PAIR', value: 3, cards: ['â™ 3', 'â™¥3'] },
                isFirstPlay: false,
                expectedValid: true
            },
            {
                desc: 'è·Ÿå¯¹å­ - å¤±è´¥ï¼ˆ33å‹44ï¼‰',
                cards: ['â™ 3', 'â™¥3'],
                lastPlay: { type: 'PAIR', value: 4, cards: ['â™ 4', 'â™¥4'] },
                isFirstPlay: false,
                expectedValid: false
            },
            {
                desc: 'è·Ÿå¯¹å­ - å¤±è´¥ï¼ˆå•ç‰Œå‹å¯¹å­ï¼‰',
                cards: ['â™ 5'],
                lastPlay: { type: 'PAIR', value: 3, cards: ['â™ 3', 'â™¥3'] },
                isFirstPlay: false,
                expectedValid: false
            },

            // 4. è·Ÿä¸‰å¼ æµ‹è¯•
            {
                desc: 'è·Ÿä¸‰å¼  - æˆåŠŸï¼ˆ444å‹333ï¼‰',
                cards: ['â™ 4', 'â™¥4', 'â™¦4'],
                lastPlay: { type: 'TRIPLE', value: 3, cards: ['â™ 3', 'â™¥3', 'â™¦3'] },
                isFirstPlay: false,
                expectedValid: true
            },

            // 5. ç‚¸å¼¹æµ‹è¯•
            {
                desc: 'ç‚¸å¼¹å‹å•ç‰Œ',
                cards: ['â™ 3', 'â™¥3', 'â™¦3', 'â™£3'],
                lastPlay: { type: 'SINGLE', value: 14, cards: ['â™ A'] },
                isFirstPlay: false,
                expectedValid: true
            },
            {
                desc: 'ç‚¸å¼¹å‹å¯¹å­',
                cards: ['â™ 3', 'â™¥3', 'â™¦3', 'â™£3'],
                lastPlay: { type: 'PAIR', value: 14, cards: ['â™ A', 'â™¥A'] },
                isFirstPlay: false,
                expectedValid: true
            },
            {
                desc: 'ç‚¸å¼¹å‹ç‚¸å¼¹ - æˆåŠŸï¼ˆ4444å‹3333ï¼‰',
                cards: ['â™ 4', 'â™¥4', 'â™¦4', 'â™£4'],
                lastPlay: { type: 'BOMB', value: 3, cards: ['â™ 3', 'â™¥3', 'â™¦3', 'â™£3'] },
                isFirstPlay: false,
                expectedValid: true
            },
            {
                desc: 'ç‚¸å¼¹å‹ç‚¸å¼¹ - å¤±è´¥ï¼ˆ3333å‹4444ï¼‰',
                cards: ['â™ 3', 'â™¥3', 'â™¦3', 'â™£3'],
                lastPlay: { type: 'BOMB', value: 4, cards: ['â™ 4', 'â™¥4', 'â™¦4', 'â™£4'] },
                isFirstPlay: false,
                expectedValid: false
            },

            // 6. ç‹ç‚¸æµ‹è¯•
            {
                desc: 'ç‹ç‚¸å‹å•ç‰Œ',
                cards: ['å¤§ç‹', 'å°ç‹'],
                lastPlay: { type: 'SINGLE', value: 15, cards: ['â™ 2'] },
                isFirstPlay: false,
                expectedValid: true
            },
            {
                desc: 'ç‹ç‚¸å‹ç‚¸å¼¹',
                cards: ['å¤§ç‹', 'å°ç‹'],
                lastPlay: { type: 'BOMB', value: 15, cards: ['â™ 2', 'â™¥2', 'â™¦2', 'â™£2'] },
                isFirstPlay: false,
                expectedValid: true
            },
            {
                desc: 'ç‚¸å¼¹å‹ä¸è¿‡ç‹ç‚¸',
                cards: ['â™ 2', 'â™¥2', 'â™¦2', 'â™£2'],
                lastPlay: { type: 'ROCKET', value: 100, cards: ['å¤§ç‹', 'å°ç‹'] },
                isFirstPlay: false,
                expectedValid: false
            },

            // 7. æ— æ•ˆç‰Œå‹æµ‹è¯•
            {
                desc: 'æ— æ•ˆç‰Œå‹ - ä¸è¿ç»­',
                cards: ['â™ 3', 'â™¥4', 'â™¦6'],
                lastPlay: null,
                isFirstPlay: true,
                expectedValid: false
            },

            // 8. ç‰Œå‹ä¸åŒ¹é…æµ‹è¯•
            {
                desc: 'ç‰Œå‹ä¸åŒ¹é… - å¯¹å­å‹å•ç‰Œ',
                cards: ['â™ 5', 'â™¥5'],
                lastPlay: { type: 'SINGLE', value: 3, cards: ['â™ 3'] },
                isFirstPlay: false,
                expectedValid: false
            },
            {
                desc: 'ç‰Œå‹ä¸åŒ¹é… - å•ç‰Œå‹ä¸‰å¼ ',
                cards: ['â™ A'],
                lastPlay: { type: 'TRIPLE', value: 3, cards: ['â™ 3', 'â™¥3', 'â™¦3'] },
                isFirstPlay: false,
                expectedValid: false
            },

            // 9. ç©ºç‰Œæµ‹è¯•
            {
                desc: 'ç©ºç‰Œ - æ²¡æœ‰é€‰æ‹©ç‰Œ',
                cards: [],
                lastPlay: null,
                isFirstPlay: true,
                expectedValid: false
            },

            // 10. ä¸Šä¸€è½®æ‰€æœ‰äººpasså
            {
                desc: 'ä¸Šä¸€è½®passå - å¯ä»¥å‡ºä»»æ„ç‰Œ',
                cards: ['â™ 3'],
                lastPlay: null,
                isFirstPlay: false,
                expectedValid: true
            }
        ];

        // è¿è¡Œæµ‹è¯•
        function runTests() {
            const resultsDiv = document.getElementById('testResults');
            const summaryDiv = document.getElementById('summary');
            
            let passCount = 0;
            let failCount = 0;

            testCases.forEach((testCase, index) => {
                const result = CardValidator.validate(
                    testCase.cards,
                    testCase.lastPlay,
                    testCase.isFirstPlay
                );
                
                const pass = result.valid === testCase.expectedValid;

                if (pass) passCount++;
                else failCount++;

                const testDiv = document.createElement('div');
                testDiv.className = `test-case ${pass ? 'pass' : 'fail'}`;
                testDiv.innerHTML = `
                    <div class="test-title">
                        ${pass ? 'âœ…' : 'âŒ'} æµ‹è¯• ${index + 1}: ${testCase.desc}
                    </div>
                    <div class="test-input">
                        å‡ºç‰Œ: [${testCase.cards.join(', ')}]
                    </div>
                    ${testCase.lastPlay ? `
                    <div class="test-input">
                        ä¸Šå®¶: ${testCase.lastPlay.type} (å€¼: ${testCase.lastPlay.value})
                    </div>
                    ` : ''}
                    <div class="test-input">
                        é¦–æ¬¡å‡ºç‰Œ: ${testCase.isFirstPlay ? 'æ˜¯' : 'å¦'}
                    </div>
                    <div class="test-result">
                        æœŸæœ›: ${testCase.expectedValid ? 'æœ‰æ•ˆ' : 'æ— æ•ˆ'} | 
                        å®é™…: ${result.valid ? 'æœ‰æ•ˆ' : 'æ— æ•ˆ'}
                        ${result.reason ? ` | åŸå› : ${result.reason}` : ''}
                        ${result.cardType ? ` | ç‰Œå‹: ${result.cardType.description}` : ''}
                    </div>
                `;

                resultsDiv.appendChild(testDiv);
            });

            // æ˜¾ç¤ºæ€»ç»“
            const total = testCases.length;
            const passRate = ((passCount / total) * 100).toFixed(1);
            summaryDiv.className = `summary ${passCount === total ? 'pass' : 'fail'}`;
            summaryDiv.innerHTML = `
                æµ‹è¯•å®Œæˆ: ${passCount}/${total} é€šè¿‡ (${passRate}%)
                ${passCount === total ? 'ğŸ‰ æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼' : 'âš ï¸ éƒ¨åˆ†æµ‹è¯•å¤±è´¥'}
            `;
        }

        // é¡µé¢åŠ è½½åè¿è¡Œæµ‹è¯•
        window.onload = runTests;
    </script>
</body>
</html>
