<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ç»“ç®—é¡µé¢æµ‹è¯•</title>
  <style>
    body {
      font-family: 'Microsoft YaHei', Arial, sans-serif;
      max-width: 800px;
      margin: 50px auto;
      padding: 20px;
      background: #f5f5f5;
    }
    h1 {
      color: #333;
      text-align: center;
    }
    .test-section {
      background: white;
      padding: 30px;
      margin: 20px 0;
      border-radius: 10px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    .test-section h2 {
      color: #667eea;
      margin-bottom: 20px;
    }
    .test-button {
      display: block;
      width: 100%;
      padding: 15px;
      margin: 10px 0;
      font-size: 16px;
      font-weight: bold;
      color: white;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      border: none;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.3s;
    }
    .test-button:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
    }
    .test-button.success {
      background: linear-gradient(135deg, #56ab2f 0%, #a8e063 100%);
    }
    .test-button.danger {
      background: linear-gradient(135deg, #eb3349 0%, #f45c43 100%);
    }
    .description {
      color: #666;
      margin: 10px 0;
      padding: 10px;
      background: #f8f9fa;
      border-left: 4px solid #667eea;
    }
    code {
      background: #f4f4f4;
      padding: 2px 6px;
      border-radius: 3px;
      font-family: 'Courier New', monospace;
    }
  </style>
</head>
<body>
  <h1>ğŸŠ ç»“ç®—é¡µé¢æµ‹è¯•å·¥å…·</h1>

  <div class="test-section">
    <h2>ğŸ“‹ æµ‹è¯•åœºæ™¯</h2>
    <p class="description">
      ç‚¹å‡»ä¸‹é¢çš„æŒ‰é’®æµ‹è¯•ä¸åŒçš„ç»“ç®—åœºæ™¯ã€‚æ¯ä¸ªæŒ‰é’®ä¼šè®¾ç½®ä¸åŒçš„æµ‹è¯•æ•°æ®å¹¶è·³è½¬åˆ°ç»“ç®—é¡µé¢ã€‚
    </p>

    <button class="test-button success" onclick="testLandlordWin()">
      ğŸ† æµ‹è¯•åœºæ™¯1: åœ°ä¸»è·èƒœ
    </button>
    <p class="description">
      åœ°ä¸»è·èƒœï¼Œæœ‰ç‚¸å¼¹ï¼Œæ€»å¾—åˆ† +4
    </p>

    <button class="test-button success" onclick="testFarmerWin()">
      ğŸ† æµ‹è¯•åœºæ™¯2: å†œæ°‘è·èƒœ
    </button>
    <p class="description">
      å†œæ°‘è·èƒœï¼Œæœ‰ç‹ç‚¸ï¼Œæ€»å¾—åˆ† +8
    </p>

    <button class="test-button success" onclick="testSpring()">
      ğŸŒ¸ æµ‹è¯•åœºæ™¯3: æ˜¥å¤©
    </button>
    <p class="description">
      åœ°ä¸»è·èƒœï¼Œæ˜¥å¤©ï¼Œå€æ•°Ã—4ï¼Œæ€»å¾—åˆ† +4
    </p>

    <button class="test-button success" onclick="testWithAchievements()">
      ğŸ… æµ‹è¯•åœºæ™¯4: å¸¦æˆå°±
    </button>
    <p class="description">
      åœ°ä¸»è·èƒœï¼Œè§£é”æˆå°±ï¼šé¦–èƒœã€ä¸‰è¿èƒœ
    </p>

    <button class="test-button" onclick="testMultipleBombs()">
      ğŸ’£ æµ‹è¯•åœºæ™¯5: å¤šä¸ªç‚¸å¼¹
    </button>
    <p class="description">
      åœ°ä¸»è·èƒœï¼Œ2ä¸ªç‚¸å¼¹ + 1ä¸ªç‹ç‚¸ï¼Œå€æ•°Ã—16
    </p>

    <button class="test-button danger" onclick="testDirectAccess()">
      ğŸ”— æµ‹è¯•åœºæ™¯6: ç›´æ¥è®¿é—®ï¼ˆæ— æ•°æ®ï¼‰
    </button>
    <p class="description">
      æ¸…é™¤localStorageï¼Œç›´æ¥è®¿é—®ç»“ç®—é¡µé¢ï¼Œä¼šæ˜¾ç¤ºæµ‹è¯•æ•°æ®
    </p>
  </div>

  <div class="test-section">
    <h2>ğŸ› ï¸ å·¥å…·</h2>
    
    <button class="test-button" onclick="viewLocalStorage()">
      ğŸ“¦ æŸ¥çœ‹ localStorage æ•°æ®
    </button>
    <p class="description">
      åœ¨æ§åˆ¶å°æŸ¥çœ‹å½“å‰ä¿å­˜çš„ç»“ç®—æ•°æ®
    </p>

    <button class="test-button danger" onclick="clearLocalStorage()">
      ğŸ—‘ï¸ æ¸…é™¤ localStorage æ•°æ®
    </button>
    <p class="description">
      æ¸…é™¤ä¿å­˜çš„ç»“ç®—æ•°æ®
    </p>
  </div>

  <div class="test-section">
    <h2>ğŸ“– è¯´æ˜</h2>
    <ul>
      <li>ç‚¹å‡»æµ‹è¯•æŒ‰é’®ä¼šè‡ªåŠ¨è·³è½¬åˆ°ç»“ç®—é¡µé¢</li>
      <li>ç»“ç®—é¡µé¢ä¼šä» <code>localStorage</code> è¯»å–æ•°æ®</li>
      <li>å¯ä»¥ç‚¹å‡»"è¿”å›å¤§å…"æˆ–"å†æ¥ä¸€å±€"æµ‹è¯•å¯¼èˆª</li>
      <li>æ‰“å¼€æµè§ˆå™¨æ§åˆ¶å°å¯ä»¥çœ‹åˆ°è¯¦ç»†æ—¥å¿—</li>
    </ul>
  </div>

  <script>
    // æµ‹è¯•åœºæ™¯1: åœ°ä¸»è·èƒœ
    function testLandlordWin() {
      const data = {
        winnerId: 'player1',
        winnerName: 'åœ°ä¸»ç©å®¶',
        winnerRole: 'landlord',
        landlordWin: true,
        roomId: 'test_room_1',
        score: {
          baseScore: 1,
          bombCount: 1,
          rocketCount: 0,
          isSpring: false,
          isAntiSpring: false,
          playerScores: [
            {
              playerId: 'player1',
              playerName: 'åœ°ä¸»ç©å®¶',
              role: 'landlord',
              finalScore: 4,
              multipliers: { base: 1, bomb: 2, rocket: 1, spring: 1, antiSpring: 1, total: 2 }
            },
            {
              playerId: 'player2',
              playerName: 'å†œæ°‘A',
              role: 'farmer',
              finalScore: -2,
              multipliers: { base: 1, bomb: 2, rocket: 1, spring: 1, antiSpring: 1, total: 2 }
            },
            {
              playerId: 'player3',
              playerName: 'å†œæ°‘B',
              role: 'farmer',
              finalScore: -2,
              multipliers: { base: 1, bomb: 2, rocket: 1, spring: 1, antiSpring: 1, total: 2 }
            }
          ]
        }
      };
      saveAndRedirect(data);
    }

    // æµ‹è¯•åœºæ™¯2: å†œæ°‘è·èƒœ
    function testFarmerWin() {
      const data = {
        winnerId: 'player2',
        winnerName: 'å†œæ°‘A',
        winnerRole: 'farmer',
        landlordWin: false,
        roomId: 'test_room_2',
        score: {
          baseScore: 1,
          bombCount: 0,
          rocketCount: 1,
          isSpring: false,
          isAntiSpring: false,
          playerScores: [
            {
              playerId: 'player1',
              playerName: 'åœ°ä¸»ç©å®¶',
              role: 'landlord',
              finalScore: -8,
              multipliers: { base: 1, bomb: 1, rocket: 4, spring: 1, antiSpring: 1, total: 4 }
            },
            {
              playerId: 'player2',
              playerName: 'å†œæ°‘A',
              role: 'farmer',
              finalScore: 4,
              multipliers: { base: 1, bomb: 1, rocket: 4, spring: 1, antiSpring: 1, total: 4 }
            },
            {
              playerId: 'player3',
              playerName: 'å†œæ°‘B',
              role: 'farmer',
              finalScore: 4,
              multipliers: { base: 1, bomb: 1, rocket: 4, spring: 1, antiSpring: 1, total: 4 }
            }
          ]
        }
      };
      saveAndRedirect(data);
    }

    // æµ‹è¯•åœºæ™¯3: æ˜¥å¤©
    function testSpring() {
      const data = {
        winnerId: 'player1',
        winnerName: 'åœ°ä¸»ç©å®¶',
        winnerRole: 'landlord',
        landlordWin: true,
        roomId: 'test_room_3',
        score: {
          baseScore: 1,
          bombCount: 0,
          rocketCount: 0,
          isSpring: true,
          isAntiSpring: false,
          playerScores: [
            {
              playerId: 'player1',
              playerName: 'åœ°ä¸»ç©å®¶',
              role: 'landlord',
              finalScore: 4,
              multipliers: { base: 1, bomb: 1, rocket: 1, spring: 2, antiSpring: 1, total: 4 }
            },
            {
              playerId: 'player2',
              playerName: 'å†œæ°‘A',
              role: 'farmer',
              finalScore: -2,
              multipliers: { base: 1, bomb: 1, rocket: 1, spring: 2, antiSpring: 1, total: 4 }
            },
            {
              playerId: 'player3',
              playerName: 'å†œæ°‘B',
              role: 'farmer',
              finalScore: -2,
              multipliers: { base: 1, bomb: 1, rocket: 1, spring: 2, antiSpring: 1, total: 4 }
            }
          ]
        }
      };
      saveAndRedirect(data);
    }

    // æµ‹è¯•åœºæ™¯4: å¸¦æˆå°±
    function testWithAchievements() {
      const data = {
        winnerId: 'player1',
        winnerName: 'æˆå°±ç©å®¶',
        winnerRole: 'landlord',
        landlordWin: true,
        roomId: 'test_room_4',
        score: {
          baseScore: 1,
          bombCount: 0,
          rocketCount: 0,
          isSpring: false,
          isAntiSpring: false,
          playerScores: [
            {
              playerId: 'player1',
              playerName: 'æˆå°±ç©å®¶',
              role: 'landlord',
              finalScore: 2,
              multipliers: { base: 1, bomb: 1, rocket: 1, spring: 1, antiSpring: 1, total: 1 }
            },
            {
              playerId: 'player2',
              playerName: 'å†œæ°‘A',
              role: 'farmer',
              finalScore: -1,
              multipliers: { base: 1, bomb: 1, rocket: 1, spring: 1, antiSpring: 1, total: 1 }
            },
            {
              playerId: 'player3',
              playerName: 'å†œæ°‘B',
              role: 'farmer',
              finalScore: -1,
              multipliers: { base: 1, bomb: 1, rocket: 1, spring: 1, antiSpring: 1, total: 1 }
            }
          ]
        },
        achievements: {
          'player1': ['first_win', 'streak_3']
        }
      };
      saveAndRedirect(data);
    }

    // æµ‹è¯•åœºæ™¯5: å¤šä¸ªç‚¸å¼¹
    function testMultipleBombs() {
      const data = {
        winnerId: 'player1',
        winnerName: 'ç‚¸å¼¹ç‹',
        winnerRole: 'landlord',
        landlordWin: true,
        roomId: 'test_room_5',
        score: {
          baseScore: 1,
          bombCount: 2,
          rocketCount: 1,
          isSpring: false,
          isAntiSpring: false,
          playerScores: [
            {
              playerId: 'player1',
              playerName: 'ç‚¸å¼¹ç‹',
              role: 'landlord',
              finalScore: 32,
              multipliers: { base: 1, bomb: 4, rocket: 4, spring: 1, antiSpring: 1, total: 16 }
            },
            {
              playerId: 'player2',
              playerName: 'å†œæ°‘A',
              role: 'farmer',
              finalScore: -16,
              multipliers: { base: 1, bomb: 4, rocket: 4, spring: 1, antiSpring: 1, total: 16 }
            },
            {
              playerId: 'player3',
              playerName: 'å†œæ°‘B',
              role: 'farmer',
              finalScore: -16,
              multipliers: { base: 1, bomb: 4, rocket: 4, spring: 1, antiSpring: 1, total: 16 }
            }
          ]
        }
      };
      saveAndRedirect(data);
    }

    // æµ‹è¯•åœºæ™¯6: ç›´æ¥è®¿é—®
    function testDirectAccess() {
      localStorage.removeItem('lastGameSettlement');
      window.location.href = '/settlement/index.html';
    }

    // ä¿å­˜æ•°æ®å¹¶è·³è½¬
    function saveAndRedirect(data) {
      console.log('ğŸ’¾ ä¿å­˜æµ‹è¯•æ•°æ®:', data);
      localStorage.setItem('lastGameSettlement', JSON.stringify(data));
      window.location.href = '/settlement/index.html';
    }

    // æŸ¥çœ‹localStorage
    function viewLocalStorage() {
      const data = localStorage.getItem('lastGameSettlement');
      if (data) {
        console.log('ğŸ“¦ localStorage æ•°æ®:');
        console.log(JSON.parse(data));
        alert('æ•°æ®å·²è¾“å‡ºåˆ°æ§åˆ¶å°ï¼Œè¯·æŒ‰F12æŸ¥çœ‹');
      } else {
        alert('localStorage ä¸­æ²¡æœ‰æ•°æ®');
      }
    }

    // æ¸…é™¤localStorage
    function clearLocalStorage() {
      localStorage.removeItem('lastGameSettlement');
      console.log('ğŸ—‘ï¸ localStorage å·²æ¸…é™¤');
      alert('localStorage å·²æ¸…é™¤');
    }
  </script>
</body>
</html>
