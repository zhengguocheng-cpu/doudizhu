# 排行榜页面使用指南

**创建时间**: 2025-10-30 10:00  
**状态**: ✅ 前端已完成，后端API已存在  
**版本**: v1.3.0-preview

---

## 📊 功能概述

排行榜页面提供两种排行榜：
1. **积分排行榜** - 按总积分排序
2. **胜率排行榜** - 按胜率排序

---

## 🎨 页面特性

### 1. 排行榜显示
- 🥇 **前三名特殊标识**
  - 第1名：金牌 🥇 + 金色字体
  - 第2名：银牌 🥈 + 银色字体
  - 第3名：铜牌 🥉 + 铜色字体
  
- 📊 **数据列**
  - 排名
  - 玩家名称（带头像）
  - 积分（橙色）
  - 场次（蓝色）
  - 胜率（绿色）

### 2. 我的排名
- 单独显示在底部
- 渐变背景高亮
- 实时更新

### 3. 交互功能
- ✅ 标签页切换（积分/胜率）
- ✅ 返回大厅按钮
- ✅ 加载动画
- ✅ 空状态提示
- ✅ 错误提示

---

## 🔗 访问方式

### 直接访问
```
http://localhost:3000/leaderboard
```

### 从其他页面跳转
```javascript
// 从大厅跳转
window.location.href = '/leaderboard/index.html';

// 从个人中心跳转
window.location.href = '/leaderboard/index.html';
```

---

## 📡 API接口

### 1. 获取排行榜
```
GET /api/score/leaderboard/:type
```

**参数**:
- `type`: 排行榜类型
  - `score` - 积分排行
  - `winRate` - 胜率排行

**响应**:
```json
{
  "success": true,
  "data": [
    {
      "userId": "player1",
      "username": "玩家1",
      "totalScore": 1250,
      "gamesPlayed": 150,
      "gamesWon": 108,
      "winRate": 0.72
    },
    ...
  ]
}
```

### 2. 获取我的排名
```
GET /api/score/:userId/rank/:type
```

**参数**:
- `userId`: 用户ID
- `type`: 排行榜类型

**响应**:
```json
{
  "success": true,
  "data": {
    "userId": "player1",
    "username": "玩家1",
    "rank": 12,
    "totalScore": 980,
    "gamesPlayed": 120,
    "winRate": 0.65
  }
}
```

---

## 🎨 UI设计

### 颜色方案
- **主色调**: 紫色渐变 (#667eea → #764ba2)
- **积分**: 橙色 (#f39c12)
- **场次**: 蓝色 (#3498db)
- **胜率**: 绿色 (#27ae60)

### 排名颜色
- **第1名**: 金色 (#FFD700)
- **第2名**: 银色 (#C0C0C0)
- **第3名**: 铜色 (#CD7F32)
- **其他**: 默认黑色

### 动画效果
- 标签页切换：淡入淡出
- 列表项悬停：向右移动 + 阴影
- 加载动画：旋转spinner

---

## 📱 响应式设计

### 桌面端 (>768px)
```
排名(80px) | 玩家(1fr) | 积分(120px) | 场次(100px) | 胜率(100px)
```

### 移动端 (≤768px)
```
排名(60px) | 玩家(1fr) | 积分(80px) | 场次(70px) | 胜率(70px)
```

---

## 🔧 技术实现

### 文件结构
```
frontend/public/leaderboard/
├── index.html          # 页面结构
├── css/
│   └── leaderboard.css # 样式文件
└── js/
    └── leaderboard.js  # 逻辑文件
```

### 核心类
```javascript
class LeaderboardPage {
  constructor()           // 初始化
  init()                  // 页面初始化
  bindEvents()            // 绑定事件
  switchTab(type)         // 切换标签页
  loadLeaderboard(type)   // 加载排行榜
  loadMyRank(type)        // 加载我的排名
  displayLeaderboard()    // 显示排行榜
  displayMyRank()         // 显示我的排名
  showLoading()           // 显示加载
  showError(message)      // 显示错误
  formatWinRate(rate)     // 格式化胜率
}
```

---

## 🧪 测试用例

### 测试1: 积分排行榜
```
步骤:
1. 访问 http://localhost:3000/leaderboard
2. 默认显示积分排行榜
3. 检查数据是否正确加载

期望:
- ✅ 显示加载动画
- ✅ 数据按积分从高到低排序
- ✅ 前三名有特殊标识
- ✅ 我的排名显示在底部
```

### 测试2: 胜率排行榜
```
步骤:
1. 点击"胜率排行"标签
2. 检查数据切换

期望:
- ✅ 标签页高亮切换
- ✅ 数据按胜率从高到低排序
- ✅ 我的排名更新
```

### 测试3: 空状态
```
步骤:
1. 清空数据库
2. 刷新排行榜页面

期望:
- ✅ 显示"暂无排行榜数据"
- ✅ 显示📊图标
```

### 测试4: 错误处理
```
步骤:
1. 停止后端服务器
2. 刷新排行榜页面

期望:
- ✅ 显示错误提示
- ✅ 显示⚠️图标
```

---

## 🎯 使用示例

### 示例1: 查看积分排行
```
1. 进入大厅页面
2. 点击"排行榜"按钮（需要添加）
3. 查看积分排行榜
4. 查看自己的排名
```

### 示例2: 查看胜率排行
```
1. 在排行榜页面
2. 点击"胜率排行"标签
3. 查看胜率排行榜
4. 对比自己的胜率
```

### 示例3: 返回大厅
```
1. 在排行榜页面
2. 点击左上角"返回大厅"按钮
3. 返回到大厅页面
```

---

## 🔄 数据更新

### 自动更新
目前排行榜数据**不会自动更新**，需要手动刷新页面。

### 手动刷新
```javascript
// 刷新当前排行榜
leaderboardPage.loadLeaderboard(leaderboardPage.currentType);
```

### 未来改进
- [ ] 添加刷新按钮
- [ ] 定时自动刷新（每30秒）
- [ ] WebSocket实时更新

---

## 🎨 样式定制

### 修改主题色
```css
/* leaderboard.css */

/* 修改主色调 */
.tab-btn.active {
  background: linear-gradient(135deg, #YOUR_COLOR1 0%, #YOUR_COLOR2 100%);
}

/* 修改排名颜色 */
.rank.top1 {
  color: #YOUR_GOLD_COLOR;
}
```

### 修改布局
```css
/* 修改列宽 */
.leaderboard-header,
.leaderboard-item {
  grid-template-columns: 80px 1fr 120px 100px 100px;
}
```

---

## 📝 待实现功能

### 高优先级
- [ ] 在大厅页面添加排行榜入口
- [ ] 在个人中心添加排行榜入口
- [ ] 添加刷新按钮
- [ ] 添加分页功能（显示前100名）

### 中优先级
- [ ] 添加搜索功能（搜索玩家）
- [ ] 添加筛选功能（按场次筛选）
- [ ] 添加时间范围选择（本周/本月/全部）
- [ ] 添加排名变化趋势（↑↓）

### 低优先级
- [ ] 添加玩家详情弹窗
- [ ] 添加排行榜历史记录
- [ ] 添加排名奖励系统
- [ ] 添加社交功能（关注/挑战）

---

## 🐛 已知问题

### 问题1: 数据为空
**现象**: 排行榜显示"暂无数据"

**原因**: 
- 数据库中没有玩家数据
- 还没有人玩过游戏

**解决**: 
- 玩几局游戏生成数据
- 或使用测试数据

### 问题2: 我的排名不显示
**现象**: 底部"我的排名"区域不显示

**原因**:
- localStorage中没有userId
- 该用户没有游戏记录

**解决**:
- 确保已登录
- 玩至少一局游戏

---

## 🚀 部署说明

### 前端部署
排行榜页面已经创建在：
```
frontend/public/leaderboard/
```

无需额外配置，直接访问即可。

### 后端API
后端API已在Phase 4实现，无需额外开发。

### 测试环境
```bash
# 启动后端
cd backend
npm run dev:watch

# 访问排行榜
http://localhost:3000/leaderboard
```

---

## 📚 相关文档

- [积分系统实现](SCORE_SYSTEM_IMPLEMENTATION_SUMMARY.md)
- [下一阶段计划](NEXT_PHASE_PLAN.md)
- [API文档](API_DOCUMENTATION.md)

---

## ✅ 完成状态

| 功能 | 状态 | 备注 |
|------|------|------|
| 前端页面 | ✅ 完成 | HTML/CSS/JS |
| 后端API | ✅ 完成 | Phase 4已实现 |
| 积分排行 | ✅ 完成 | 可用 |
| 胜率排行 | ✅ 完成 | 可用 |
| 我的排名 | ✅ 完成 | 可用 |
| 响应式设计 | ✅ 完成 | 支持移动端 |
| 大厅入口 | ⏳ 待添加 | 需要修改大厅页面 |
| 刷新功能 | ⏳ 待添加 | 未来改进 |
| 分页功能 | ⏳ 待添加 | 未来改进 |

---

**排行榜页面已创建完成！现在可以访问查看了。** 🎉

**创建时间**: 2025-10-30 10:00  
**创建者**: AI Assistant  
**版本**: v1.3.0-preview
